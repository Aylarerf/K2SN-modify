p:=257;
F:=GF(p);
w:= F!42;

n := 64;
m := 16;

a := [[202, 48, 66, 143, 188, 159, 123, 206, 209, 184, 177, 135, 236, 138, 214, 187, 46, 21, 99, 14, 60, 220, 164, 58, 122, 6, 32, 167, 147, 27, 52, 221, 76, 245, 236, 136, 150, 104, 214, 104, 160, 9, 111, 142, 147, 71, 201, 65, 219, 172, 207, 151, 137, 243, 81, 5, 121, 113, 44, 14, 13, 96, 107, 89 ],
[213, 89, 225, 108, 193, 185, 85, 99, 66, 68, 113, 85, 11, 186, 151, 230, 104, 103, 254, 113, 91, 80, 118, 85, 194, 34, 99, 79, 2, 206, 168, 216, 167, 10, 69, 106, 67, 26, 77, 133, 95, 62, 219, 106, 248, 115, 209, 97, 90, 208, 83, 53, 33, 201, 138, 99, 236, 109, 178, 238, 188, 218, 71, 100 ],
[229, 13, 78, 168, 39, 27, 47, 6, 89, 138, 240, 83, 125, 194, 52, 215, 19, 135, 140, 179, 209, 151, 24, 62, 132, 74, 172, 192, 165, 244, 38, 11, 2, 243, 179, 168, 16, 98, 175, 232, 236, 160, 60, 106, 226, 240, 193, 245, 120, 206, 169, 201, 102, 65, 8, 106, 12, 53, 44, 177, 42, 209, 60, 171 ],
[197, 239, 84, 85, 83, 131, 63, 191, 36, 250, 43, 134, 235, 108, 124, 101, 59, 166, 174, 33, 103, 183, 140, 115, 236, 56, 164, 150, 10, 224, 66, 207, 81, 22, 165, 36, 154, 228, 227, 62, 223, 142, 69, 204, 251, 65, 177, 182, 231, 96, 88, 207, 151, 100, 194, 4, 156, 104, 154, 166, 200, 92, 245, 153 ],
[242, 155, 189, 13, 0, 34, 202, 224, 176, 16, 45, 44, 82, 222, 227, 185, 190, 60, 137, 214, 160, 77, 218, 188, 53, 245, 99, 125, 209, 216, 24, 196, 117, 85, 209, 244, 119, 29, 213, 41, 45, 130, 85, 127, 224, 184, 58, 160, 116, 67, 119, 148, 16, 209, 81, 69, 199, 52, 67, 26, 14, 91, 222, 3 ],
[48, 49, 247, 168, 78, 78, 81, 123, 208, 38, 123, 178, 223, 53, 210, 84, 247, 201, 233, 9, 155, 186, 78, 227, 239, 145, 253, 253, 108, 92, 128, 157, 141, 120, 197, 91, 70, 23, 87, 24, 61, 210, 74, 156, 135, 29, 113, 127, 230, 218, 136, 2, 149, 87, 229, 133, 104, 227, 3, 213, 65, 131, 242, 78 ],
[124, 56, 170, 194, 79, 2, 90, 12, 84, 164, 169, 219, 65, 154, 218, 40, 117, 100, 43, 11, 59, 144, 17, 163, 117, 20, 248, 54, 24, 235, 132, 20, 36, 174, 86, 242, 176, 177, 0, 132, 213, 41, 96, 24, 195, 60, 191, 57, 32, 234, 195, 91, 124, 212, 254, 113, 105, 248, 167, 1, 100, 171, 21, 9 ],
[91, 107, 123, 139, 156, 250, 17, 115, 36, 240, 11, 103, 172, 202, 32, 76, 54, 100, 167, 50, 57, 39, 35, 34, 159, 74, 35, 131, 245, 183, 12, 208, 163, 136, 220, 64, 131, 237, 51, 40, 94, 62, 15, 139, 137, 48, 215, 63, 148, 128, 113, 77, 39, 148, 112, 198, 222, 19, 201, 84, 75, 214, 38, 238 ],
[95, 3, 174, 98, 112, 226, 138, 78, 160, 154, 217, 169, 74, 178, 232, 94, 178, 217, 171, 217, 237, 155, 32, 76, 47, 105, 161, 122, 64, 71, 232, 31, 201, 151, 2, 185, 249, 140, 8, 155, 166, 226, 196, 112, 21, 174, 206, 199, 8, 250, 33, 246, 150, 192, 67, 69, 42, 100, 191, 234, 171, 168, 137, 244 ],
[192, 139, 174, 186, 152, 55, 86, 190, 153, 155, 48, 174, 74, 126, 245, 209, 121, 150, 200, 144, 214, 13, 213, 128, 240, 22, 107, 157, 62, 245, 18, 254, 1, 193, 186, 153, 248, 144, 89, 18, 44, 137, 192, 245, 8, 54, 200, 2, 204, 17, 146, 35, 157, 231, 163, 143, 253, 143, 45, 61, 5, 63, 187, 6 ],
[128, 245, 160, 248, 135, 249, 11, 51, 3, 75, 169, 138, 129, 241, 140, 205, 3, 158, 240, 161, 135, 149, 49, 5, 37, 221, 193, 42, 156, 126, 175, 30, 116, 80, 150, 123, 201, 162, 47, 76, 109, 216, 215, 239, 202, 227, 189, 205, 3, 47, 238, 10, 68, 32, 15, 105, 253, 209, 19, 27, 207, 194, 57, 195 ],
[147, 79, 64, 93, 113, 111, 170, 223, 199, 2, 207, 18, 101, 13, 223, 104, 187, 207, 114, 0, 111, 2, 105, 237, 211, 251, 9, 163, 191, 193, 103, 83, 17, 39, 48, 131, 22, 90, 99, 93, 219, 178, 111, 66, 63, 80, 42, 251, 159, 29, 251, 15, 31, 229, 124, 114, 225, 133, 149, 33, 71, 124, 243, 89 ],
[36, 37, 92, 58, 127, 191, 152, 92, 241, 135, 30, 49, 215, 199, 45, 246, 228, 42, 134, 131, 16, 3, 245, 113, 137, 11, 147, 80, 136, 135, 169, 172, 172, 6, 102, 172, 69, 126, 136, 55, 7, 38, 105, 94, 237, 22, 213, 211, 64, 92, 214, 207, 222, 77, 66, 231, 88, 85, 57, 96, 220, 226, 140, 10 ],
[105, 243, 54, 46, 241, 190, 102, 120, 228, 79, 215, 210, 101, 45, 38, 38, 137, 253, 117, 231, 75, 55, 208, 35, 140, 10, 132, 233, 108, 17, 243, 85, 132, 42, 132, 246, 104, 106, 111, 204, 185, 198, 159, 158, 243, 70, 68, 252, 195, 186, 229, 142, 241, 182, 177, 254, 192, 181, 232, 172, 71, 220, 3, 203 ],
[134, 135, 66, 110, 241, 178, 59, 43, 248, 218, 73, 237, 160, 142, 234, 100, 200, 80, 242, 58, 7, 37, 57, 71, 218, 34, 244, 34, 126, 119, 110, 132, 254, 176, 242, 112, 226, 46, 27, 220, 137, 227, 74, 42, 114, 53, 15, 186, 6, 129, 245, 13, 166, 47, 212, 2, 209, 73, 36, 80, 192, 146, 85, 191 ],
[195, 72, 175, 166, 119, 202, 131, 128, 46, 77, 170, 161, 3, 57, 219, 9, 187, 209, 149, 225, 129, 106, 227, 83, 179, 136, 35, 116, 154, 120, 179, 94, 65, 99, 6, 56, 173, 9, 184, 220, 87, 226, 253, 90, 29, 89, 226, 88, 44, 120, 58, 45, 227, 158, 128, 23, 39, 35, 140, 193, 28, 191, 160, 93 ]];

x := [[69, 61, 60, 60, 70, 62, 61, 73, 67, 79, 70, 78, 56, 62, 65, 59, 72, 71, 66, 66, 58, 59, 67, 71, 64, 64, 61, 64, 62, 58, 63, 69, 67, 72, 67, 70, 65, 73, 70, 63, 56, 78, 65, 60, 70, 67, 67, 72, 69, 60, 59, 68, 61, 65, 55, 64, 63, 66, 63, 66, 65, 73, 69, 65 ],
[64, 62, 66, 75, 63, 64, 69, 67, 63, 59, 64, 58, 63, 69, 63, 68, 66, 58, 67, 65, 66, 68, 70, 80, 63, 57, 59, 63, 65, 59, 71, 56, 64, 70, 63, 69, 63, 55, 66, 63, 78, 61, 59, 71, 61, 56, 71, 65, 68, 65, 69, 73, 79, 69, 68, 65, 58, 73, 72, 66, 63, 57, 61, 71 ],
[72, 72, 58, 65, 61, 61, 68, 71, 61, 72, 70, 67, 83, 59, 66, 75, 58, 74, 62, 65, 64, 62, 67, 64, 68, 68, 73, 62, 59, 66, 66, 71, 69, 60, 69, 61, 66, 68, 67, 53, 67, 61, 67, 56, 64, 67, 68, 63, 70, 70, 57, 71, 70, 65, 62, 59, 68, 63, 77, 60, 60, 66, 70, 61 ],
[67, 70, 71, 65, 67, 69, 61, 57, 67, 56, 71, 60, 60, 62, 68, 58, 64, 71, 67, 62, 56, 69, 63, 73, 67, 54, 63, 69, 68, 68, 71, 62, 58, 62, 64, 67, 64, 62, 66, 69, 66, 75, 65, 66, 73, 57, 74, 70, 66, 64, 56, 72, 58, 70, 61, 68, 64, 61, 68, 60, 62, 67, 66, 68 ],
[68, 65, 71, 58, 61, 72, 69, 65, 72, 70, 67, 74, 56, 56, 66, 70, 64, 62, 61, 63, 65, 59, 71, 72, 66, 50, 59, 66, 64, 64, 69, 71, 62, 62, 61, 58, 71, 69, 59, 66, 63, 74, 62, 58, 55, 70, 66, 65, 62, 72, 64, 71, 60, 67, 74, 64, 58, 69, 65, 64, 59, 80, 68, 62 ],
[72, 55, 62, 72, 61, 68, 57, 67, 76, 61, 57, 58, 60, 60, 63, 68, 57, 60, 56, 67, 56, 62, 77, 73, 71, 62, 62, 63, 59, 64, 72, 51, 65, 68, 60, 73, 74, 60, 64, 65, 62, 61, 67, 59, 66, 68, 62, 59, 56, 63, 77, 67, 61, 63, 59, 72, 55, 61, 68, 73, 63, 69, 74, 73 ],
[79, 60, 69, 64, 70, 74, 70, 63, 62, 67, 68, 74, 61, 73, 78, 73, 64, 75, 65, 62, 70, 68, 67, 62, 58, 61, 70, 57, 68, 67, 70, 75, 71, 68, 67, 72, 65, 53, 61, 62, 62, 65, 67, 55, 62, 65, 74, 74, 76, 63, 66, 68, 66, 59, 61, 67, 63, 70, 67, 63, 63, 68, 63, 70 ],
[59, 65, 56, 66, 61, 69, 73, 61, 71, 65, 52, 72, 65, 63, 63, 57, 58, 73, 63, 74, 69, 59, 59, 68, 72, 67, 70, 47, 69, 52, 67, 59, 65, 74, 58, 77, 63, 63, 62, 68, 53, 69, 70, 60, 64, 62, 63, 62, 59, 62, 60, 61, 66, 64, 61, 65, 72, 60, 68, 76, 65, 74, 67, 79 ],
[52, 67, 71, 67, 61, 68, 74, 68, 72, 73, 54, 71, 76, 70, 66, 62, 70, 63, 66, 69, 66, 67, 60, 66, 59, 65, 66, 61, 76, 73, 65, 69, 74, 63, 70, 66, 73, 60, 64, 58, 64, 68, 69, 71, 69, 58, 59, 70, 55, 70, 55, 64, 68, 62, 68, 71, 69, 60, 67, 70, 63, 61, 69, 68 ],
[49, 61, 70, 66, 62, 61, 55, 54, 77, 67, 68, 73, 59, 58, 67, 64, 65, 66, 67, 68, 57, 55, 61, 67, 66, 68, 63, 71, 60, 69, 70, 69, 63, 70, 61, 64, 64, 56, 69, 63, 73, 69, 69, 57, 70, 63, 53, 59, 75, 58, 76, 66, 79, 66, 64, 71, 62, 69, 85, 71, 71, 62, 65, 71 ],
[65, 71, 58, 58, 66, 62, 54, 59, 62, 62, 64, 61, 70, 71, 56, 59, 71, 68, 60, 72, 67, 65, 65, 63, 58, 62, 73, 59, 62, 68, 65, 61, 68, 66, 69, 72, 60, 72, 59, 54, 63, 67, 72, 67, 64, 72, 72, 70, 51, 59, 71, 62, 51, 68, 60, 62, 68, 72, 66, 60, 69, 71, 60, 60 ],
[58, 64, 69, 68, 74, 82, 58, 63, 65, 66, 71, 70, 73, 61, 69, 64, 67, 66, 61, 65, 67, 64, 70, 55, 62, 65, 52, 64, 71, 58, 74, 64, 70, 57, 63, 70, 67, 67, 66, 56, 64, 72, 67, 71, 66, 52, 70, 78, 75, 60, 64, 67, 70, 78, 71, 68, 68, 66, 68, 65, 61, 71, 68, 60 ],
[59, 69, 78, 69, 64, 61, 62, 68, 82, 62, 77, 62, 60, 74, 65, 65, 86, 73, 67, 78, 64, 62, 65, 64, 60, 67, 59, 61, 56, 64, 72, 72, 56, 62, 59, 70, 64, 74, 70, 52, 68, 58, 54, 74, 64, 75, 62, 65, 71, 66, 61, 63, 66, 59, 74, 76, 53, 59, 74, 74, 66, 52, 65, 70 ],
[58, 52, 69, 76, 74, 73, 61, 67, 64, 68, 52, 75, 72, 64, 62, 65, 74, 58, 68, 61, 74, 59, 63, 77, 70, 62, 60, 71, 75, 82, 62, 64, 68, 68, 68, 60, 72, 57, 85, 59, 64, 59, 66, 63, 68, 69, 73, 67, 75, 61, 55, 57, 71, 60, 66, 68, 61, 76, 67, 68, 75, 67, 63, 68 ],
[68, 69, 68, 67, 71, 74, 69, 72, 75, 67, 71, 72, 61, 74, 68, 62, 69, 64, 74, 71, 69, 57, 71, 64, 63, 73, 70, 74, 74, 70, 69, 66, 59, 68, 65, 73, 70, 63, 53, 66, 67, 66, 63, 76, 66, 73, 65, 62, 74, 53, 67, 62, 62, 68, 62, 62, 67, 67, 70, 70, 62, 76, 67, 72 ],
[76, 63, 79, 69, 66, 58, 65, 62, 69, 64, 66, 63, 72, 80, 73, 67, 61, 65, 61, 56, 61, 65, 58, 65, 61, 60, 59, 69, 65, 74, 68, 69, 61, 63, 70, 68, 60, 67, 78, 68, 67, 66, 61, 71, 68, 66, 66, 51, 66, 69, 68, 71, 56, 60, 62, 63, 54, 65, 65, 60, 54, 67, 68, 65 ]];


t:=[];
for i:=1 to 16 do
	t1:=[];
	for k:= 0 to 3 do
		t1:= Append(t1,x[i][16*0+4*k+1]);
		t1:= Append(t1,x[i][16*1+4*k+1]);
		t1:= Append(t1,x[i][16*2+4*k+1]);
		t1:= Append(t1,x[i][16*3+4*k+1]);

		t1:= Append(t1,x[i][16*0+4*k+2]);
		t1:= Append(t1,x[i][16*1+4*k+2]);
		t1:= Append(t1,x[i][16*2+4*k+2]);
		t1:= Append(t1,x[i][16*3+4*k+2]);

		t1:= Append(t1,x[i][16*0+4*k+3]);
		t1:= Append(t1,x[i][16*1+4*k+3]);
		t1:= Append(t1,x[i][16*2+4*k+3]);
		t1:= Append(t1,x[i][16*3+4*k+3]);

		t1:= Append(t1,x[i][16*0+4*k+4]);
		t1:= Append(t1,x[i][16*1+4*k+4]);
		t1:= Append(t1,x[i][16*2+4*k+4]);
		t1:= Append(t1,x[i][16*3+4*k+4]);
	end for;
	t:=Append(t,t1);
end for;
x:=t;
/*t:=[];
for i:=1 to 16 do
	t1:=[];
	for k:= 0 to 3 do
		t1:= Append(t1,a[i][16*0+4*k+1]);
		t1:= Append(t1,a[i][16*1+4*k+1]);
		t1:= Append(t1,a[i][16*2+4*k+1]);
		t1:= Append(t1,a[i][16*3+4*k+1]);

		t1:= Append(t1,a[i][16*0+4*k+2]);
		t1:= Append(t1,a[i][16*1+4*k+2]);
		t1:= Append(t1,a[i][16*2+4*k+2]);
		t1:= Append(t1,a[i][16*3+4*k+2]);

		t1:= Append(t1,a[i][16*0+4*k+3]);
		t1:= Append(t1,a[i][16*1+4*k+3]);
		t1:= Append(t1,a[i][16*2+4*k+3]);
		t1:= Append(t1,a[i][16*3+4*k+3]);

		t1:= Append(t1,a[i][16*0+4*k+4]);
		t1:= Append(t1,a[i][16*1+4*k+4]);
		t1:= Append(t1,a[i][16*2+4*k+4]);
		t1:= Append(t1,a[i][16*3+4*k+4]);
	end for;
	t:=Append(t,t1);
end for;
a:= t;
/*t:=[];
for i:=1 to 16 do
	t1:=[];
	for k:= 0 to 3 do
		t1:= Append(t1,x[i][k+1+4*0]);
		t1:= Append(t1,x[i][k+1+4*1]);
		t1:= Append(t1,x[i][k+1+4*2]);
		t1:= Append(t1,x[i][k+1+4*3]);
		t1:= Append(t1,x[i][k+1+4*4]);
		t1:= Append(t1,x[i][k+1+4*5]);
		t1:= Append(t1,x[i][k+1+4*6]);
		t1:= Append(t1,x[i][k+1+4*7]);
		t1:= Append(t1,x[i][k+1+4*8]);
		t1:= Append(t1,x[i][k+1+4*9]);
		t1:= Append(t1,x[i][k+1+4*10]);
		t1:= Append(t1,x[i][k+1+4*11]);
		t1:= Append(t1,x[i][k+1+4*12]);
		t1:= Append(t1,x[i][k+1+4*13]);
		t1:= Append(t1,x[i][k+1+4*14]);
		t1:= Append(t1,x[i][k+1+4*15]);
	end for;
	t:=Append(t,t1);
end for;
x:=t;
print x;*/

y := [];
for j := 1 to m do
	y_temp := [];
	for i:=1 to 64 do
		t := 0;
		for k:=1 to 64 do
			t := t + x[j][k]*w^(k-1)*w^(2*(i-1)*(k-1));
		end for;
		y_temp := Append(y_temp,t);
	end for;
	y := Append(y,y_temp);
end for;

A:=[];
for j := 1 to m do
	y_temp := [];
	for i:=1 to 64 do
		t := 0;
		for k:=1 to 64 do
			t := t + a[j][k]*w^(k-1)*w^(2*(i-1)*(k-1));
		end for;
		y_temp := Append(y_temp,t);
	end for;
	A := Append(A,y_temp);
end for;
opt := [];
for j:= 1 to 16 do
	re := [];
	for i:=1 to 64 do
		re := Append(re,A[j][i]*y[j][i]);
	end for;
	opt := Append(opt,re);
end for;

op := [];
for i:=1 to 64 do
	t := opt[1][i] + opt[2][i] + opt[3][i] + opt[4][i] + opt[5][i] + opt[6][i] + opt[7][i] + opt[8][i];
	t := t + opt[9][i] + opt[10][i] + opt[11][i] + opt[12][i] + opt[13][i] + opt[14][i] + opt[15][i] + opt[16][i];
	op := Append(op,t);
end for;

print op;

